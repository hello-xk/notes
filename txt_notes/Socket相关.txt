Socket相关
一个端口，只能绑定一个Socket，对应一个Socket fd。

aton使用的是sin_addr.s_addr
pton使用的是sin_addr
其他相同

1，服务端
	本地一个端口，只能绑定在一个Socket fd进行监听。（不知道fd的复制可以不）


2，客户端
	一个TCP只能在一个端口上，但并不是与服务器的连接只能有一个，也并不是说与服务器通信只能通过那个连接。
	客户端可以与服务器建立多个连接：
	本地端口6000 -》 服务器端口8080		第一个fd		服务器有1个连接
	本地端口6001 -》 服务器端口8080		第二个fd		服务器有2个连接
	本地端口6003 -》 服务器端口8080		第三个fd		服务器有3个连接

	一般系统只能有65535个端口，换言之，只可以建立65535个连接。这与fd是无关的，fd只是指向这些连接。多个fd可以同时指向同一个文件或连接。
	端口数会限制连接数。除此之外，还有fd，因为需要通过fd来操作连接。

3，分析
	连接过程： 
	1，先创建fd。		端口再多，fd不够，可以建立端口数个连接，但是同时能够处理的只是fd数个连接。不过，可以将这些fd的值加入队列进行保存，后续处理。这时，这个问题转变为共享资源问题。所以，即使只有一个fd，但是有很多端口，也可以顺利建立端口数个连接，并进行监听。因为fd毕竟只是一个值,一个指针，一个指向连接的指针。丢失一个fd，只是丢失了一个指针。
	2，再连接/监听。		fd再多，端口不够，也只能建立端口数个连接。

	假如一台设备只有4个端口，那么，
			作为客户端： 这台设备最多只能同时建立4个连接。
			作为服务器： 则只需占用一个端口而可以建立很多连接。但同时能处理的连接数与fd相关。
	假如一台设备只能支持6个fd，那么，
			作为客户端： 这台设备最多只能同时处理6个连接，当然，这6个fd可以同时指向同一个连接或同一个文件。
			作为服务端： 这台设备只能同时处理6个连接。
	假如一台设备只有4个端口，6个fd，那么，
			作为客户端： 这台设备最多只能同时建立4个连接，同时能处理4个连接。

	select可以监听一系列fd是否可读可写。

	目的是： 提供IO效率。即提高写入缓冲的效率。

    多个fd可以用于保存这些连接，有数据读写的时候可以直接读写，减少建立连接的时间花费。


现在问题是：
	客户端连接同一个服务器，多个fd与一个fd的通信有什么区别？ 多个fd能够更高效率吗？
	
	1，单线程考虑：	单线程里，只能一个包一个包地发送，这和建立多个连接其实没关系，一个连接也是这样传输，两个连接也是这样传输。
	2，多线程考虑：	多线程里，多线程下载文件，会比一个线程下载要快，这是什么道理？

		服务器每给你发一定的数据包，还会检查你是否接到，有没有丢失数据等。
		而且服务器和你一般不是直接连接的，中间没准经过多少个路由或各种设备。
		所以，单线程时，服务器只会一个包发送，然后等待应答，再发下一个包。
		     多线程时，服务器会接收到多个请求，会为每一个请求发出一个包，然后等待，所以，有多少个线程，则可能会发多少个包出去，并等待。
		但是，为什么一般是5～10个，（CPU的个数的两倍再加二）？再多就无效了呢？
		一般是从服务器方考虑，服务器会对这方面做限制，你客户端并没有限制，但是只要服务器不给你用，你多开了也白费阿
		现在多数网站都支持多线程下载，但是有些网站为了提供给更多的带宽给新下载的用户，防止某个IP在下载的时候占用太多的带宽，会有意地中断部分连接，以控制流量.
		正所谓“欲速则不达”，如果盲目地增加进程的数量，会给自己的计算机和服务器带来巨大的CPU处理时间和内存的开销，就会造成服务器崩溃，完全无法响应任何请求，自然也就无法下载了。即使没有崩溃，过多的进程也会使服务器花费许多不必要的资源在进程之间的管理和协调上，每个进程发送数据的实际效率反而下降。 
		现在，使用ADSL、专线和宽带网等高速接入的人也越来越多，那么，这些用户是不是也应该以完全使用带宽为标准来调节下载的进程数呢？答案也是否定的。 
		第一，要考虑服务器的负载能力，如果把服务器“拖”垮了，大家都没得下，相信“吃快弄破碗”的道理不难理解。 
		第二，通常一条高速接入的线路是供一个局域网或一个小区(特别是宽带网)使用的，在没有使用带宽限制的情况下，带宽是由各用户共享的，如果大家都使用多进程来抢占带宽就只会恶性循环造成代理服务器死机或网络阻塞。 
		第三，在高速的情况下，多进程下载会使硬盘在为每个进程记录数据时频繁换道，既大大增加了CPU占用，又严重降低了硬盘寿命。解决办法除了减少进程数量以外(一般5个进程已经足够)，还可以增大内存缓冲的容量，在网络蚂蚁和网际快车里，通过“选项→参数设置→高级→自动保存任务每隔？KB”和“工具→选项→常规→把数据写入到磁盘每当接收到？KB”都可以很轻松地调节，根据机器配置和网络速度选择即可。


